some code changes from GitHub
